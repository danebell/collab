####################
# DEPENDENCY RULES #
####################

- name: "${label}-syntax-noun-1"
  example: "BOEM and BSEE are currently in ESA consultation with NMFS and FWS"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^N/]
    actor1:Entity+ = (<xcomp /${pos_verbs}/)? >nsubj /${continuance}/{,2}
    actor2:Entity+ = >nmod_with /${continuance}/{,2}

- name: "${label}-syntax-noun-2"
  example: "BOEM is currently engaged in ESA consultation with FWS and NMFS"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^N/]
    actor1:Entity+ = <nmod_in (<xcomp /${pos_verbs}/)? >nsubjpass /${continuance}/{,2}
    actor2:Entity+ = <nmod_in? >nmod_with /${continuance}/{,2}

- name: "${label}-syntax-noun-3"
  example: "Section 106 consultation for the proposed action was initiated by the DOE with the Louisiana and Texas SHPOs"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^N/]
    actor1:Entity+ = <nsubjpass >/nmod_(by|agent)/ /${continuance}/{,2}
    actor2:Entity+ = <nsubjpass >nmod_with /${continuance}/{,2}

- name: "${label}-syntax-noun-between-1"
  example: "Informal consultation between Golden Pass and the DOT regarding additional LNG and pipeline safety and federal safety standards is currently ongoing."
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^N/]
    actor:Entity+ = >nmod_between /${continuance}/{,2}

- name: "${label}-syntax-noun-with-1"
  example: "As the lead federal agency, the FERC is responsible for the Section 7 consultation with the FWS."
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^N/]
    actor1:Entity+ = <nmod_for [word=/^(responsible|accountable)$/] >nsubj /${continuance}/{,2}
    actor2:Entity+ = <nmod_for? >nmod_with /${continuance}/{,2}

- name: "${label}-syntax-noun-initiate-1"
  example: "Golden Pass initiated informal consultation with the FWS, NOAA Fisheries, the TPWD, and the LDWF"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^N/]
    actor1:Entity+ = <dobj ([tag=/^V/] <xcomp)? [tag=/^VB(D|Z|P|N)$/] >nsubj /${continuance}/{,2}
    actor2:Entity+ = <dobj? >nmod_on? >nmod_with /${continuance}/{,2}

- name: "${label}-syntax-noun-initiate-2"
  example: "The NRC initiated consultation on the proposed action by writing to the Florida SHPO and the Advisory Council on Historic Preservation."
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^N/]
    actor1:Entity+ = <dobj ([tag=/^V/] <xcomp)? [tag=/^VB(D|Z|P|N)$/] >nsubj /${continuance}/{,2}
    actor2:Entity+ = <dobj >advcl >/nmod/ /${continuance}/{,2}

- name: "${label}-syntax-noun-in-consultation-with-1"
  example: "In consultation with the FWS, NOAA Fisheries, Golden Pass initially identified 8 federally listed species"
  #example: "In consultation with the TPWD and the LDWF, we identified 18 additional species"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^N/]
    actor1:Entity+ = </nmod_(in|based)/ ((<xcomp /${pos_verbs}/)? >nsubj)? /${continuance}/{,2}
    actor2:Entity+ = >nmod_with /${continuance}/{,2}

- name: "${label}-syntax-noun-in-consultation-with-2"
  example: "It joined  the  Coastal  Resources  Commission  (CRC)  in  consultation  with  the  Division  of Coastal  Management  (DCM)"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^N/]
    actor1:Entity+ = </nmod_(in|based)/ >dobj /${continuance}/{,2}
    actor2:Entity+ = >nmod_with /${continuance}/{,2}

- name: "${label}-syntax-noun-completed-1"
  example: "Sabine Pass LNG completed Section 7 of the ESA consultation with the FWS, NOAA Fisheries, and the LDWF"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^N/]
    actor1:Entity+ = <nmod_of? <dobj [lemma=complete & tag=/^VB[DZPGN]/] >nsubj /${continuance}/{,2}
    actor2:Entity+ = >nmod_with /${continuance}/{,2}

- name: "${label}-syntax-noun-acting-1"
  example: "BOEM is acting as lead agency in the reinitiated consultation, with BSEE involvement."
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^N/]
    actor1:Entity+ = <nmod_in? <nmod_as [lemma=act] >nsubj /${continuance}/{,2}
    actor2:Entity+ = <nmod_in? <nmod_as [lemma=act] >nmod_with /${continuance}/{,2}

- name: "${label}-syntax-noun-poss-1"
  example: "The NRC’s and FPL’s consultation with the Florida SHPO concluded yesterday."
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^N/]
    actor1:Entity+ = (>/nmod:poss/ | >compound | <conj) /${continuance}/{,2}
    actor2:Entity+ = >nmod_with /${continuance}/{,2}

- name: "${label}-syntax-noun-following"
  example: "Following consultation with the Commandant of the U.S. Coast Guard and the Secretary of the Interior, USEPA assumed air quality responsibility"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^N/]
    actor1:Entity+ = </nmod_(in|following)/ (<conj | >conj)* >nsubj /${continuance}/{,2}
    actor2:Entity+ = >nmod_with (>/nmod_of|conj/)* /${continuance}/{,2}

- name: "${label}-syntax-verb-1"
  example: "In addition, the FERC consults with the FWS and NOAA Fisheries"
  #example: "TVA is consulting with the USFWS over the potential effects to this species."
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^VB[DZPGN]/]
    actor1:Entity+ = <acl? (<xcomp /${pos_verbs}/)? >/nsubj(pass)?/ /${continuance}/{,2}
    actor2:Entity+ = (>nmod_with | >dobj)? /${continuance}|dep/{,3}

- name: "${label}-syntax-verb-1b-wrong"
  example: "DOE has noted that, as part of an air permit application, Lake Charles Cogeneration, LLC, previously consulted with the Louisiana SHPO"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^VB[DZPGN]/]
    actor1:Entity+ = <acl /${continuance}/{,2}
    actor2:Entity+ = >nmod_with /${continuance}/{,2}

- name: "${label}-syntax-verb-2a"
  example: "In addition, the FERC is required to consult with the FWS and NOAA Fisheries"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=VB]
    actor1:Entity+ = <xcomp [lemma=require] >nsubjpass /${continuance}/{,2}
    actor2:Entity+ = <xcomp? >nmod_with /${continuance}/{,2}

- name: "${label}-syntax-verb-2b"
  example: "Federal law requires us to consult with the DOD to determine whether there would be any impacts"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=VB]
    actor1:Entity+ = <xcomp [lemma=require] >dobj /${continuance}/{,2}
    actor2:Entity+ = <xcomp? >nmod_with /${continuance}/{,2}

- name: "${label}-syntax-verb-3"
  example: "The USACE will continue to consult with the Seminole Tribe of Florida and the Miccosukee Tribe of Indians of Florida on the development of the work plan."
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=VB]
    actor1:Entity+ = <xcomp [lemma=continue] >nsubj /${continuance}/{,2}
    actor2:Entity+ = <xcomp? >nmod_with /${continuance}/{,2}

- name: "${label}-syntax-verb-4"
  example: "The Jena Band of Choctaw Indians requested to be consulted by FERC"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^VB[ND]/]
    actor1:Entity+ = <ccomp [lemma=/(?i)^(request|ask|demand|petition|appeal)$/] >nsubj /${continuance}/{,2}
    actor2:Entity+ = >/nmod_(by|agent)/ /${continuance}/{,2}

- name: "${label}-syntax-verb-5"
  example: "She is a member  of  the  CRC, which is advised by the Science  Panel  on  Coastal  Hazards"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/^(${trigger})/ & tag=/^V/]
    actor1:Entity+ = >/nmod_(by|agent)/ /${continuance}/{,2}
    actor2:Entity+ = (<xcomp /${pos_verbs}/)? >/nsubj(pass)?/ /${continuance}/{,2}

- name: "${label}-syntax-noun-team-1"
  example: "A   team   of   resource   professionals,   including representatives  from  the Cape  Fear  River  Watch and  UNC  Wilmington conducted  a  follow-up  field investigation of the identified degradation issues."
  example: "A team including UNC and the FDA."
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/^(${trigger})/ & tag=/^N/]
    actor:Entity+ = >/nmod_(of|between)/? >/nmod_(including|including)/{,2} /${continuance}/{,2}

- name: "${label}-syntax-noun-counsel-1"
  example: "The Miles  Firm is legal counsel to the Authority Board and continues to  advise  staff  regarding  in-house  legal  issues."
  example: "The Miles  Firm acts as legal counsel to the Authority Board"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=counsel & tag=/^N/]
    actor1:Entity+ = >nsubj /${continuance}/{,2}
    actor2:Entity+ = >/nmod_(for|of|to)/ /${continuance}/{,2}

- name: "${label}-syntax-noun-meet-1"
  example: "Parsons had discussions with the US Army Corps of Engineers."
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/^(${trigger})/ & tag=/^N/]
    actor1:Entity+ = <dobj [lemma=/^(call|lead|have)$/] >nsubj /${continuance}/{,2}
    actor2:Entity+ = <dobj? >nmod_with? >nmod_at? >nmod_of? /${continuance}/{,2}

- name: "${label}-syntax-noun-talks-between-1"
  example: "Talks between the City of Wilmington and CFRW continue regarding maintenance of public BMPs."
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/^(${trigger})/ & tag=/^N/]
    actor:Entity+ = >nmod_between >nmod_of? /${continuance}/{,2}

- name: "${label}-syntax-verb-work-1"
  example: "DCM  is  also working with  FEMA, the NSF, and Governor  Kilgrave"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^V/]
    actor1:Entity+ = >nmod_with /${continuance}/{,2}
    actor2:Entity+ = (<xcomp /${pos_verbs}/)? >nsubj /${continuance}/{,2}

- name: "${label}-syntax-verb-advises-1"
  example: "She is a member  of  the  Science  Panel  on  Coastal  Hazards, which  advises  the  CRC  and  DCM"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^V/]
    actor1:Entity+ = (<xcomp /${pos_verbs}/)? >nsubj /${continuance}/{,2}
    actor2:Entity+ = >dobj /${continuance}/{,2}

- name: "${label}-syntax-verb-work-2"
  example: "DCM  and FEMA are working together to kill the moon"
  label: ${label}
  action: ${eventAction}
  pattern: |
    trigger = [lemma=/(?i)^(${trigger})/ & tag=/^V/]
    actor:Entity+ = (<xcomp /${pos_verbs}/)? >nsubj /${continuance}/{,2}

###############
# TOKEN RULES #
###############

- name: "${label}-in-consultation-token"
  example: "It directed  the  Coastal  Resources  Commission  (CRC)  in  consultation  with  the  Division  of Coastal  Management  (DCM),  Division  of  Land  Resources,  and  the  Coastal  Resources Advisory  Council  (CRAC)  to  study  the  use  and  applicability  of  a  terminal  groin  as  an erosion  control  device."
  label: ${label}
  action: ${eventAction}
  type: token
  pattern: |
    @actor:Entity
    in [lemma=/^(${trigger})/ & tag=/^N/]
    with
    @actor:Entity
    (("," [tag=DT]* @actor:Entity)*
    ","? (and | as well as) [tag=DT]* @actor:Entity)?

- name: "${label}-reinitate-token"
  example: "On July 30, 2010, BOEMRE reinitiated ESA Section 7 Consultation on the previous 2007-2012 WPA/CPA Multisale EIS with both FWS and NMFS."
  label: ${label}
  action: ${eventAction}
  type: token
  pattern: |
    @actor1:Entity
    [! tag=/^VB/ & ! mention=Entity]*
    [word=/(?i)^(${posVerbs})/ & tag=/^VB/]
    [! tag=/^VB/]*
    would?
    (?<trigger> [lemma=consultation])
    [! tag=/^VB/]*
    with
    both?
    @actor2:Entity
    (("," @actor2:Entity)?
     (and | as well as) @actor2:Entity)?

